<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Viewer</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        table { width: 90%; margin: 20px auto; border-collapse: separate; background-color: #274f52; border-radius: 10px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.03em;}
        th, td { padding: 10px; text-align: center; border-radius: 10px; background-color: #ffffff;
            box-shadow: 0px 0px 9px 0px rgba(0,0,0,0.1);}
        button { margin: 5px; padding: 10px; cursor: pointer; }
        

        /* Responsive Adjustments */
        @media (max-width: 1024px) {
            table {
                width: 95%;
                font-size: 13px;
            }
            th, td {
                padding: 8px;
            }
            button {
                font-size: 13px;
                padding: 7px 10px;
            }
        }
        
        @media (max-width: 768px) {
            table {
                width: 100%;
                font-size: 12px;
            }
            th, td {
                padding: 6px;
            }
            button {
                font-size: 12px;
                padding: 6px 8px;
            }
        }
        
        @media (max-width: 480px) {
            table {
                font-size: 11px;
                border-radius: 5px;
            }
            th, td {
                padding: 5px;
                font-size: 11px;
            }
            button {
                font-size: 11px;
                padding: 5px 7px;
            }
        }
        
        .link{
            text-decoration: none;
            text-shadow: #111;
            color: #111;
            font-weight: 500;
        }
        /* CSS */
        button {
          padding: 0.6em 2em;
          margin: 10px;
          border: none;
          outline: none;
          color: rgb(255, 255, 255);
          background: #111;
          cursor: pointer;
          position: relative;
          z-index: 0;
          border-radius: 10px;
          user-select: none;
          -webkit-user-select: none;
          touch-action: manipulation;
        }

        button:before {
          content: "";
          background: linear-gradient(
            45deg,
            #ff0000,
            #ff7300,
            #fffb00,
            #48ff00,
            #00ffd5,
            #002bff,
            #7a00ff,
            #ff00c8,
            #ff0000
          );
          position: absolute;
          top: -2px;
          left: -2px;
          background-size: 400%;
          z-index: -1;
          filter: blur(5px);
          -webkit-filter: blur(5px);
          width: calc(100% + 4px);
          height: calc(100% + 4px);
          animation: glowing-button-85 20s linear infinite;
          transition: opacity 0.3s ease-in-out;
          border-radius: 10px;
        }

        @keyframes glowing-button-85 {
          0% {
            background-position: 0 0;
          }
          50% {
            background-position: 400% 0;
          }
          100% {
            background-position: 0 0;
          }
        }
        button:after {
          z-index: -1;
          content: "";
          position: absolute;
          width: 100%;
          height: 100%;
          background: #222;
          left: 0;
          top: 0;
          border-radius: 10px;
        }

         /* Modal (Canvas) Styling */
         .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }
        .image-container {
            position: relative;
            overflow: auto;
            max-width: 90vw; /* Limits width */
            max-height: 80vh; /* Limits height */
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .image-container img {
            display: block;
            max-width: none;
            max-height: none;
            transform-origin: center;
            transition: transform 0.3s ease-in-out;
        }
        .modal img {
            max-width: 90%;
            max-height: 80vh;
            border-radius: 10px;
            margin-top: 20px;
            transform-origin: center;
            transition: transform 0.3s ease-in-out;
            cursor: grab; /* Shows grabbing cursor */
        }
        .modal img:active {
            cursor: grabbing; /* Shows grabbing cursor when dragging */
        }
        .close {
            position: absolute;
            top: 0px;
            right: 15px;
            font-size: 42px;
            cursor: pointer;
            z-index: 1;
            color: #111;
        }
        .nav-btn {
            margin: 10px;
            padding: 10px;
        }
        /* Responsive Adjustments */
        @media (max-width: 1024px) {
            .modal-content {
                max-width: 85%;
                padding: 8px;
            }
            .modal img {
                max-width: 85%;
                max-height: 75vh;
            }
            .close {
                font-size: 28px;
                top: 8px;
                right: 12px;
            }
            .nav-btn {
                font-size: 13px;
                padding: 8px 12px;
            }
        }

        @media (max-width: 768px) {
            .modal-content {
                max-width: 90%;
                padding: 6px;
            }
            .modal img {
                max-width: 80%;
                max-height: 70vh;
            }
            .close {
                font-size: 24px;
                top: 5px;
                right: 10px;
            }
            .nav-btn {
                font-size: 12px;
                padding: 7px 10px;
            }
        }

        @media (max-width: 480px) {
            .modal-content {
                max-width: 95%;
                padding: 5px;
            }
            .modal img {
                max-width: 75%;
                max-height: 65vh;
            }
            .close {
                font-size: 22px;
                top: 5px;
                right: 8px;
            }
            .nav-btn {
                font-size: 11px;
                padding: 6px 8px;
            }
        }
    </style>
</head>
<body>
    <h1 style="position: relative;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); margin-top: 40px;">CUET-PG Exam Paper (Hindi)</h1>
    <button id="download-all">Download All</button>
    <table>
        <thead>
            <tr>
                <th>Page No</th>
                <th>Image Link</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="image-list"></tbody>
    </table>

    <!-- Modal (Canvas) -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <p id="page-number" style="color: rgb(32, 26, 26); font-size: 18px; margin-bottom: 10px; font-weight: 700; z-index: 1;"></p> <!-- Page Number -->
            <span class="close" onclick="closeModal()">&times;</span>
            <!-- <img id="modal-img" src="" alt="Image Preview"> -->
            <div class="image-container">
                <img id="modal-img" src="" alt="Image Preview">
            </div>
            <div>
                <button class="nav-btn" onclick="prevImage()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <button onclick="toggleFullScreen()">
                    <span class="fullscreen-icon" onclick="toggleFullScreen()">
                        <svg id="fullscreen-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 4H10V6H6V10H4V4Z" fill="currentColor"/>
                            <path d="M14 4H20V10H18V6H14V4Z" fill="currentColor"/>
                            <path d="M4 20V14H6V18H10V20H4Z" fill="currentColor"/>
                            <path d="M20 20H14V18H18V14H20V20Z" fill="currentColor"/>
                        </svg>
                    </span></button>
                <button class="nav-btn" onclick="nextImage()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
            <div>
                <button class="zoom-btn" onclick="zoomIn()">Zoom In</button>
                <button class="zoom-btn" onclick="zoomOut()">Zoom Out</button>
                <button class="zoom-btn" onclick="resetZoom()">Reset</button>
            </div>
        </div>
    </div>

    <!-- <script>
        fetch('http://127.0.0.1:5000/api/images')
    .then(response => response.json())
    .then(data => {
        const container = document.getElementById('image-list');
        data.forEach((url, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${index + 1}</td>
                <td><a class="link" href="${url}" target="_blank" style="pointer-events: none">${url}</a></td>
                <td class="buttonc">
                    <a href="${url}" target="_blank"><button>View</button></a>
                    <a href="${url}" download><button>Download</button></a>
                </td>
            `;
            container.appendChild(row);
        });
    })
    .catch(error => console.error('Error fetching images:', error));

    document.getElementById('download-all').addEventListener('click', () => {
        imageUrls.forEach(url => {
            const link = document.createElement('a');
            link.href = url;
            link.download = url.split('/').pop();
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    });
    </script> -->
    <script>
        let imageUrls = [];
        let currentIndex = 0;
        let zoomLevel = 1;

    fetch('image_urls.json')
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById('image-list');
            imageUrls = data;
            data.forEach((url, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><a class="link" href="${url}" target="_blank" style="pointer-events: none">${url}</a></td>
                    <td>
                        <button onclick="openModal(${index})">View</button>
                        <!-- <a href="${url}" target="_blank"><button>View</button></a> -->
                        <button class="download-btn" data-url="${url}">Download</button>
                    </td>
                `;
                container.appendChild(row);
            });
        
            document.querySelectorAll('.download-btn').forEach(button => {
                button.addEventListener('click', async (event) => {
                    const url = event.target.getAttribute('data-url');
                    await downloadImage(url);
                });
            });
        })
        .catch(error => console.error('Error loading JSON:', error));
    
    async function downloadImage(url) {
        try {
            const response = await fetch(url, { mode: 'no-cors' });
            const blob = await response.blob();
            const blobUrl = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = blobUrl;
            link.download = url.split('/').pop();
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(blobUrl);
        } catch (error) {
            console.error('Download failed:', error);
        }
    }
    
    document.getElementById('download-all').addEventListener('click', async () => {
        for (const url of imageUrls) {
            await downloadImage(url);
        }
    });

    const pageNumber = document.getElementById("page-number"); // Page number display

    function openModal(index) {
        currentIndex = index;
        document.getElementById('modal-img').src = imageUrls[currentIndex];
        document.getElementById('modal').style.display = 'flex';
        // Update page number
        pageNumber.textContent = `Page No: ${currentIndex + 1}`;
    }

    // Function to toggle fullscreen mode
    function toggleFullScreen() {
        const modalImg = document.getElementById('modal-img');
        if (!document.fullscreenElement) {
            if (modalImg.requestFullscreen) {
                modalImg.requestFullscreen();
            } else if (modalImg.mozRequestFullScreen) {
                modalImg.mozRequestFullScreen(); // Firefox
            } else if (modalImg.webkitRequestFullscreen) {
                modalImg.webkitRequestFullscreen(); // Chrome, Safari, and Opera
            } else if (modalImg.msRequestFullscreen) {
                modalImg.msRequestFullscreen(); // IE/Edge
            }
        } else {
            document.exitFullscreen();
        }
    }

    function closeModal() {
        document.getElementById('modal').style.display = 'none';
        zoomLevel = 1;
        document.getElementById('modal-img').style.transform = `scale(${zoomLevel})`;
    }

    function nextImage() {
        if (currentIndex < imageUrls.length - 1) {
            currentIndex++;
            document.getElementById('modal-img').src = imageUrls[currentIndex];
            zoomLevel = 1;
            document.getElementById('modal-img').style.transform = `scale(${zoomLevel})`;
            // Update page number
            pageNumber.textContent = `Page No: ${currentIndex + 1}`;
        }
    }

    function prevImage() {
        if (currentIndex > 0) {
            currentIndex--;
            document.getElementById('modal-img').src = imageUrls[currentIndex];// Update page number
            zoomLevel = 1;
            document.getElementById('modal-img').style.transform = `scale(${zoomLevel})`;
            pageNumber.textContent = `Page No: ${currentIndex + 1}`;
        }
    }

    function updateImage() {
        zoomLevel = 1;
        const img = document.getElementById('modal-img');
        img.src = imageUrls[currentIndex];
        img.style.transform = `scale(${zoomLevel})`;
    }

    function zoomIn() {
        zoomLevel += 0.2;
        document.getElementById('modal-img').style.transform = `scale(${zoomLevel})`;
    }

    function zoomOut() {
        if (zoomLevel > 0.4) {
            zoomLevel -= 0.2;
            document.getElementById('modal-img').style.transform = `scale(${zoomLevel})`;
        }
    }

    function resetZoom() {
        zoomLevel = 1;
        document.getElementById('modal-img').style.transform = `scale(${zoomLevel})`;
    }

    // Zoom using mouse wheel
    document.getElementById('modal').addEventListener('wheel', (event) => {
        if (event.deltaY < 0) {
            zoomIn();
        } else {
            zoomOut();
        }
        event.preventDefault();
    });
    </script>
</body>
</html>
